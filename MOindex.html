<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>é«¦ MORE HAIRSTYLE | å°å—å°ˆæ¥­é«®å»Šèˆ‡é ‚ç´šè­·é«®ç”¢å“</title>
    <meta name="description" content="å°å—å®‰å¹³å€æ¨è–¦é«®å»Š MORE HAIRSTYLEã€‚æä¾›å°ˆæ¥­å‰ªé«®ã€æŸ“é«®ã€ç‡™é«®æœå‹™ï¼Œä¸¦è²©å”® R.O.8ã€æ—¥æœ¬AQUAç¢³é…¸æ³‰ç­‰é ‚ç´šæ²™é¾å°ˆç”¨æ´—é«®ç²¾èˆ‡è­·é«®ç”¢å“ã€‚">
    <meta name="keywords"
        content="ç¢³é…¸æ´—é«®, ç¢³é…¸æ³‰, ç¢³é…¸, æ—¥æœ¬ç¢³é…¸, å°å—é«®å»Š, æŸ“é«®, å°å—æŸ“é«®, å®‰å¹³å‰ªé«®, é ­çš®è­·ç†, é ­çš®é¤Šè­·, é ­çš®èª¿ç†, è­·é«®ç”¢å“, æ´—é«®ç²¾æ¨è–¦, MORE HAIRSTYLE, R.O.8, æŸ“é«®æ¨è–¦">
    <meta name="author" content="MORE HAIRSTYLE">

    <meta property="og:title" content="é«¦ MORE HAIRSTYLE | æ‰“é€ å°ˆå±¬æ‚¨çš„ç¨ç‰¹é¢¨æ ¼">
    <meta property="og:description" content="åš´é¸é ‚ç´šæ²™é¾å°ˆç”¨ç”¢å“ï¼Œè®“å±…å®¶è­·ç†ä¹Ÿèƒ½æ“æœ‰æ²™é¾ç´šè³ªæ„Ÿã€‚è–èª•é™å®šå„ªæƒ çµ„åˆç†±è³£ä¸­ï¼">
    <meta property="og:image" content="/uploads/shop.db.jpeg">
    <meta property="og:type" content="website">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="css/styles.css">
    <!-- Inline style block removed in favor of css/styles.css -->
</head>

<body>
    <header>
        <!-- Logo (åŸæœ¬æ˜¯ç½®ä¸­ï¼Œæ‰‹æ©Ÿç‰ˆæ”¹å·¦é‚Š) -->
        <h1><a href="MOindex.html">MORE HAIRSTYLE</a></h1>

        <!-- æ¼¢å ¡æŒ‰éˆ• -->
        <div class="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <nav>
            <ul class="mobile-menu">
                <li class="dropdown">
                    <a href="MOindex.html?cat=all"
                        style="padding-bottom: 30px; margin-bottom: -30px; display: inline-block;">æ‰€æœ‰å•†å“ â–¾</a>
                    <div class="dropdown-content">
                        <a href="MOindex.html?cat=all">å…¨éƒ¨å•†å“</a>
                        <a href="MOindex.html?cat=æ´—é«®">æ´—é«®</a>
                        <a href="MOindex.html?cat=ä¿é¤Š">ä¿é¤Š</a>
                        <a href="MOindex.html?cat=ç…¥é‡‡">ç…¥é‡‡</a>
                        <a href="MOindex.html?cat=æ´»èƒ">æ´»æ·¬</a>
                        <a href="MOindex.html?cat=R.O.8">R.O.8</a>
                        <a href="MOindex.html?cat=æ—¥æœ¬">æ—¥æœ¬</a>
                        <a href="MOindex.html?cat=éŸ“åœ‹">éŸ“åœ‹</a>
                        <a href="MOindex.html?cat=å…¶ä»–">å…¶ä»–</a>
                    </div>
                </li>
                <!-- è«‹åœ¨æ‚¨éƒ¨ç½²æ–°ç¶²ç«™å¾Œï¼Œå°‡ä¸‹æ–¹çš„ href æ”¹æˆæ–°ç¶²ç«™çš„ç¶²å€ (ä¾‹å¦‚ https://momo-aqua.onrender.com) -->
                <li><a href="https://moreaquasite.onrender.com" target="_blank" class="btn-nav">æ—¥æœ¬ç¢³é…¸æ³‰</a></li>
                <li><a href="MOabout.html">é—œæ–¼æˆ‘å€‘</a></li>
                <li><a href="MOcart.html">ğŸ›’ è³¼ç‰©è»Š <span id="cart-count" class="cart-count">0</span></a></li>
            </ul>
        </nav>
    </header>

    <div id="home-banner">

        <div class="story-section video-section">
            <picture class="bg-media">
                <source media="(max-width: 768px)" srcset="/uploads/shop.db_m.jpeg">
                <img src="/uploads/shop.db.jpeg" alt="Background" style="width: 100%; height: 100%; object-fit: cover;">
            </picture>

            <video class="bg-video" id="hero-video" muted loop playsinline autoplay>
                <source src="/uploads/ç°¡å ±1æ©«.mp4" type="video/mp4">
            </video>

            <div class="overlay"></div>
            <div class="story-content visible">
                <h2 class="story-title">WELCOME TO MOREHAIRSTYLE</h2>
                <p class="story-desc">é«¦<br>æ„Ÿå—æœ€çœŸå¯¦çš„æ²™é¾é«”é©—</p>
            </div>
        </div>


        <div class="story-section">
            <picture class="bg-media">
                <source media="(max-width: 768px)" srcset="/uploads/2026_m.jpg">
                <img src="/uploads/2026.jpg" alt="Background">
            </picture>
            <div class="overlay"></div>
            <div class="story-content">
                <h2 class="story-title">Happy New Year</h2>
                <p class="story-desc">éå¹´é™å®šå„ªæƒ çµ„åˆ<br>çµ¦è‡ªå·±ä¸€ä»½æœ€æº«æš–çš„ç¦®ç‰©</p>
            </div>
        </div>



        <div class="story-section" id="section-professional">
            <picture class="bg-media">
                <source media="(max-width: 768px)" srcset="/uploads/MOREHAIRSTYLE-m.jpg">
                <img src="/uploads/MOREHAIRSTYLE.jpg" alt="Background" style="object-position: center center;">
            </picture>
            <div class="overlay"></div>
            <div class="story-content">
                <h2 class="story-title">Professional Care</h2>
                <p class="story-desc">åš´é¸é ‚ç´šæ²™é¾å°ˆç”¨ç”¢å“<br>è®“å±…å®¶è­·ç†ä¹Ÿèƒ½æ“æœ‰æ²™é¾ç´šè³ªæ„Ÿ</p>
            </div>
        </div>

        <div class="story-section">
            <picture class="bg-media">
                <source media="(max-width: 768px)" srcset="/uploads/æ°´åº•ç¢³é…¸_m.png">
                <img src="/uploads/æ°´åº•ç¢³é…¸.png" alt="Background">
            </picture>
            <div class="overlay"></div>
            <div class="story-content">
                <h2 class="story-title">More Styles</h2>
                <p class="story-desc">æ¢ç´¢æ›´å¤šé€ å‹<br>ç™¼ç¾ä¸ä¸€æ¨£çš„è‡ªå·±</p>
            </div>
        </div>

    </div>

    <main id="product-section" class="container" style="display: none;">
        <h2 id="page-title" style="text-align: center; margin-bottom: 2rem;">æ‰€æœ‰å•†å“</h2>
        <div id="product-grid" class="product-grid"></div>
    </main>

    <script>
        window.products = [];

        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('momoCart')) || [];
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').innerText = count;
        }

        // ==========================================
        // âœ¨ [éŸ¿æ‡‰å¼å½±ç‰‡] æ ¹æ“šè¢å¹•å¤§å°åˆ‡æ›å½±ç‰‡ä¾†æº âœ¨
        // ==========================================
        function setupResponsiveVideo() {
            const heroVideo = document.getElementById('hero-video');
            if (!heroVideo) return;

            const isMobile = window.matchMedia('(max-width: 768px)').matches;
            const source = heroVideo.querySelector('source');
            const mobileVideoSrc = '/uploads/slide1_m.mp4';
            const desktopVideoSrc = '/uploads/ç°¡å ±1æ©«.mp4';
            const targetSrc = isMobile ? mobileVideoSrc : desktopVideoSrc;

            // åªæœ‰ç•¶ä¾†æºä¸åŒæ™‚æ‰é‡æ–°è¼‰å…¥
            if (source.src !== window.location.origin + targetSrc) {
                source.src = targetSrc;
                heroVideo.load();
            }
        }

        // é é¢è¼‰å…¥æ™‚èˆ‡è¦–çª—å¤§å°æ”¹è®Šæ™‚åŸ·è¡Œ
        window.addEventListener('resize', setupResponsiveVideo);

        // ==========================================
        // âœ¨ [æ»¾å‹•åµæ¸¬] æ–‡å­—æµ®ç¾ & å½±ç‰‡æ’­æ”¾æ§åˆ¶ âœ¨
        // ==========================================
        function initScrollAnimation() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    const video = entry.target.querySelector('video');

                    if (entry.isIntersecting) {
                        // 1. æ–‡å­—å‹•ç•«ï¼šåŠ ä¸Š .visible é¡åˆ¥è®“æ–‡å­—æµ®ä¸Šä¾†
                        const content = entry.target.querySelector('.story-content');
                        if (content) content.classList.add('visible');

                        // 2. å½±ç‰‡æ§åˆ¶ï¼šæ»‘åˆ°æ‰æ’­æ”¾ (ç¯€çœæ•ˆèƒ½)
                        if (video) {
                            video.play().catch(e => console.log("è‡ªå‹•æ’­æ”¾éœ€ä½¿ç”¨è€…äº’å‹•"));
                        }
                    } else {
                        // 3. å½±ç‰‡æ§åˆ¶ï¼šæ»‘èµ°å°±æš«åœ
                        if (video) video.pause();
                    }
                });
            }, { threshold: 0.3 }); // 30% é€²å…¥ç•«é¢æ™‚è§¸ç™¼

            document.querySelectorAll('.story-section').forEach(section => {
                observer.observe(section);
            });
        }

        async function fetchProducts() {
            try {
                const response = await fetch('/api/products');
                if (!response.ok) throw new Error('é€£ç·šå¤±æ•—');
                window.products = await response.json();
                render();
            } catch (error) {
                console.error(error);
                if (document.getElementById('product-section').style.display !== 'none') {
                    document.getElementById('product-grid').innerHTML = '<p style="text-align:center;">ç„¡æ³•é€£ç·šåˆ°ä¼ºæœå™¨ (è«‹ç¢ºèªç¶²è·¯é€£ç·š)</p>';
                }
            }
        }

        function render() {
            const params = new URLSearchParams(window.location.search);
            const category = params.get('cat');

            const bannerSection = document.getElementById('home-banner');
            const productSection = document.getElementById('product-section');
            const container = document.getElementById('product-grid');

            // [è‡ªå®šç¾©æ’åº] åˆ†é¡é †åºè¡¨
            const categoryOrder = [
                "æ´—é«®", "æŸ“é«®", "ç‡™é«®", "ä¿é¤Š", "ç…¥é‡‡",
                "æ´»èƒ", "R.O.8", "S.I.G", "æ—¥æœ¬", "éŸ“åœ‹", "å…¶ä»–"
            ];

            if (category) {
                // ==========================================
                // âœ¨ æ¨¡å¼ Aï¼šå•†å“åˆ—è¡¨æ¨¡å¼ (é—œé–‰æ²å‹•æ•æ‰) âœ¨
                // ==========================================
                // é—œéµï¼šç§»é™¤ snap-activeï¼Œæ¢å¾©ä¸€èˆ¬ç¶²é çš„è‡ªç”±æ»¾å‹•ï¼Œè§£æ±ºå›å½ˆå•é¡Œ
                document.documentElement.classList.remove('snap-active');

                bannerSection.style.display = 'none';
                productSection.style.display = 'block';

                let displayList = [];

                if (category === 'all') {
                    // âœ¨ æƒ…æ³ï¼šé»æ“Šã€Œæ‰€æœ‰å•†å“ã€ -> é¡¯ç¤ºå…¨éƒ¨ä¸¦æ’åº âœ¨
                    document.getElementById('page-title').innerText = "æ‰€æœ‰å•†å“";
                    displayList = [...window.products];

                    // åŸ·è¡Œæ’åºé‚è¼¯
                    displayList.sort((a, b) => {
                        const getOrderIndex = (product) => {
                            const cats = Array.isArray(product.category) ? product.category : [product.category];
                            let minIndex = 999;
                            cats.forEach(c => {
                                const idx = categoryOrder.indexOf(c);
                                if (idx !== -1 && idx < minIndex) minIndex = idx;
                            });
                            return minIndex;
                        };
                        return getOrderIndex(a) - getOrderIndex(b);
                    });
                } else {
                    // âœ¨ æƒ…æ³ï¼šé»æ“Šç‰¹å®šåˆ†é¡ -> åªéæ¿¾è©²åˆ†é¡ âœ¨
                    document.getElementById('page-title').innerText = `${category} ç³»åˆ—`;
                    displayList = window.products.filter(p => {
                        if (Array.isArray(p.category)) return p.category.includes(category);
                        return p.category === category;
                    });
                }

                if (displayList.length === 0) {
                    container.innerHTML = '<p style="grid-column: 1/-1; text-align:center;">æ­¤åˆ†é¡å°šç„¡å•†å“</p>';
                    return;
                }

                let html = '';
                displayList.forEach(p => {
                    let imageList = (p.images && p.images.length > 0) ? p.images : [p.image];
                    let posList = (p.image_positions && p.image_positions.length > 0) ? p.image_positions : Array(imageList.length).fill('center center');
                    let rotList = (p.image_rotations && p.image_rotations.length > 0) ? p.image_rotations : Array(imageList.length).fill(0);

                    let imgHtml = '';
                    imageList.forEach((src, index) => {
                        const activeClass = (index === 0) ? 'active' : '';
                        const positionStyle = `object-position: ${posList[index] || 'center center'};`;
                        const rotationStyle = `transform: rotate(${rotList[index] || 0}deg);`;

                        // âœ¨ æ–°å¢ï¼šç¬¬ä¸€å¼µåœ–ç«‹å³è¼‰å…¥ï¼Œå…¶ä»–åœ–è¨­å®šç‚º lazy (å»¶é²è¼‰å…¥) âœ¨
                        // é€™æ¨£å¯ä»¥å¤§å¹…æ¸›å°‘ä¸€é–‹å§‹çš„ç¶²è·¯å¡è»Š
                        const loadingAttr = (index === 0) ? '' : 'loading="lazy"';

                        imgHtml += `<img src="${src}" alt="${p.name}" ${loadingAttr} class="card-img ${activeClass}" style="${positionStyle} ${rotationStyle}" onerror="this.src='https://placehold.co/400x400?text=No+Image'">`;
                    });

                    html += `
                        <div class="product-card" onclick="window.location.href='MOproduct.html?id=${p.id}'">
                            <div class="card-image-box">${imgHtml}</div>
                            <div class="product-info">
                                <h3>${p.name}</h3>
                                <p style="font-size: 0.9rem;">é»æ“ŠæŸ¥çœ‹è©³æƒ…</p>
                                <span class="btn-buy">ç­è§£æ›´å¤š</span>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = html;
                setTimeout(setupHoverSlideshow, 100);

            } else {
                // ==========================================
                // âœ¨ æ¨¡å¼ Bï¼šé¦–é å½¢è±¡æ¨¡å¼ (é–‹å•Ÿæ²å‹•æ•æ‰) âœ¨
                // ==========================================
                // é—œéµï¼šåŠ å…¥ snap-activeï¼Œå•Ÿå‹•å¼·åˆ¶åˆ†é æ•ˆæœ
                document.documentElement.classList.add('snap-active');

                bannerSection.style.display = 'block';
                productSection.style.display = 'none';

                initScrollAnimation();
            }

            updateCartCount();
        }

        // å•†å“åœ–ç‰‡è¼ªæ’­æ•ˆæœ (æ»‘é¼ æ‡¸åœæ™‚)
        function setupHoverSlideshow() {
            const cards = document.querySelectorAll('.product-card');
            cards.forEach(card => {
                const imageBox = card.querySelector('.card-image-box');
                if (!imageBox) return;
                const images = imageBox.querySelectorAll('img');

                images.forEach((img, idx) => {
                    if (idx === 0) img.classList.add('active');
                    else img.classList.remove('active');
                });

                card.hoverInterval = null;

                if (images.length > 1) {
                    card.addEventListener('mouseenter', () => {
                        if (card.hoverInterval) return;
                        card.hoverInterval = setInterval(() => {
                            let activeIndex = -1;
                            images.forEach((img, idx) => { if (img.classList.contains('active')) activeIndex = idx; });
                            if (activeIndex === -1) activeIndex = 0;
                            images[activeIndex].classList.remove('active');
                            let nextIndex = (activeIndex + 1) % images.length;
                            images[nextIndex].classList.add('active');
                        }, 1500);
                    });
                    card.addEventListener('mouseleave', () => {
                        if (card.hoverInterval) { clearInterval(card.hoverInterval); card.hoverInterval = null; }
                        images.forEach(img => img.classList.remove('active'));
                        if (images[0]) images[0].classList.add('active');
                    });
                }
            });
        }

        window.onload = function () {
            setupResponsiveVideo(); // åˆå§‹åŒ–éŸ¿æ‡‰å¼å½±ç‰‡
            fetchProducts();
        };
        // ==========================================
        // âœ¨ [æ¼¢å ¡é¸å–®] æ‰‹æ©Ÿç‰ˆåˆ‡æ› âœ¨
        // ==========================================
        const hamburger = document.querySelector('.hamburger');
        const navUl = document.querySelector('nav ul');

        if (hamburger) {
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                navUl.classList.toggle('active');
            });

            // é»æ“Šé€£çµå¾Œè‡ªå‹•æ”¶èµ·é¸å–® (æ’é™¤ dropdown æŒ‰éˆ•)
            document.querySelectorAll('nav a').forEach(link => {
                link.addEventListener('click', (e) => {
                    // å¦‚æœæ˜¯ dropdown çš„è§¸ç™¼æŒ‰éˆ•ï¼Œåªå±•é–‹/æ”¶åˆï¼Œä¸é—œé–‰å´é‚Šé¸å–®
                    const parentDropdown = link.closest('.dropdown');
                    if (parentDropdown && link === parentDropdown.querySelector(':scope > a')) {
                        e.preventDefault();
                        parentDropdown.classList.toggle('active');
                        return;
                    }
                    // å…¶ä»–é€£çµï¼šé—œé–‰å´é‚Šé¸å–®
                    hamburger.classList.remove('active');
                    navUl.classList.remove('active');
                });
            });
        }
    </script>
</body>

</html>